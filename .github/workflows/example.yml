name: Tester et déployer

on:
  push:
    branches: [ "main" ]
    
  pull_request:
    branches: 
      -"main" 

jobs:
  mon-premier-job: # par exemple run test 
    runs-on: ubuntu-latest
    steps:
      - name: afficher une variable 
        run: echo $NAME
        env:
          NAME : marco
          
      - name: lister fichiers 
        run: ls -la 
        
      - name: cloner le répo
        uses: actions/checkout@v4 # checkout repo
        
      - name: lister fichiers
        run: ls -la
        
      - name: Utiliser une variable au niveau du répo
        run: echo ${{vars.NAME}}
        
      - name: Utiliser un secret 
        run: echo $MY_PASSWORD > example.txt
        env: 
          MY_PASSWORD: ${{secrets.PASSWORD}}
          
      - name: Afficher contenu du fichier
        run: cat example.txt
        
  test: # par exemple  : second-job
    runs-on: ubuntu-latest
    steps:
      - name: lister fichiers
        run: ls -la
        
      - name: cloner le répo
        uses: actions/checkout@v4
        
      - name: installer python
        uses: actions/setup-python@v5
        with:
          python-version: 3.11
          
      - name:  montrer la version de python installée
        run: python --version

      - name: installer les dépendances
        run: |
          pip install -r requirements.txt
          pip install pytest
        
      - name: Lancer les tests
        run: python -m pytest tests/
        
        
